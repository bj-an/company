<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sample">

	<select id="selectBoardList" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
		SELECT
		    IDX,
		    TITLE,
		    WRITER2,
		    HIT_CNT,
		    TO_CHAR(CREA_DTM , 'yyyy-mm-dd')    AS CREA_DTM
		FROM
		    TB_BOARD
		WHERE
			DEL_GB = 'N'    
		ORDER BY IDX 
		]]>
	</select>
	
	<select id="selectBoardsList" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
		SELECT
			NO,
			BGNO,
			BONAME,
			WRITER2,
			TO_CHAR(CREA_DTM , 'yyyy-mm-dd')    AS CREA_DTM
		FROM
			TB_BOARD_LIST
		ORDER BY BGNO
		]]>
	</select>
	
	<insert id="insertBoard" parameterType="hashmap"> <![CDATA[ 
 	INSERT INTO TB_BOARD ( 
 	 	IDX
 	 	,TITLE
 	 	,CONTENTS
 	 	,HIT_CNT
 	 	,DEL_GB
 	 	,CREA_DTM
 	 	,WRITER2  
 	 )VALUES (
	  	SEQ_TB_BOARD_IDX.NEXTVAL
	  	,#{TITLE}
	  	,#{CONTENTS}
	  	,0
	  	,'N'
	  	,TO_CHAR(SYSDATE , 'yyyy-mm-dd')
	  	,'admin'
	  )
	 ]]>
	</insert>

	<update id="updateHitCnt" parameterType="hashmap"> <![CDATA[ 
	UPDATE TB_BOARD 
	
	SET
	 HIT_CNT = NVL(HIT_CNT, 0) + 1 
	
	 WHERE
	 IDX = #{IDX} 
	
	]]>
	</update>


	<select id="selectBoardDetail" parameterType="hashmap"
		resultType="hashmap"> <![CDATA[ 
		SELECT IDX
		, HIT_CNT
		, WRITER2
		, CREA_DTM
		, TITLE
		, CONTENTS FROM TB_BOARD WHERE IDX = #{IDX}
		
		 ]]>
	</select>

	<update id="updateBoard" parameterType="hashmap"> 
	<![CDATA[ 
	UPDATE TB_BOARD SET 
	TITLE = #{TITLE}
	, CONTENTS = #{CONTENTS} 
	WHERE
	 IDX = #{IDX} 
 	]]>
	</update>


	<update id="deleteBoard" parameterType="hashmap"> 
	<![CDATA[ 
	UPDATE TB_BOARD
	 SET 
	 DEL_GB = 'Y'
	  WHERE 
	  IDX = #{IDX}
	   ]]>
	</update>

	<insert id="insertAddBoard" parameterType="hashmap"> <![CDATA[ 
 	INSERT INTO TB_BOARD_LIST ( 
 	 	NO
 	 	,BGNO
 	 	,BONAME
 	 	,WRITER2
 	 	,CREA_DTM
 	 )VALUES (
	  	tb_board_list_seq.NEXTVAL
	  	,#{BGNO}
	  	,#{BONAME}
	  	,'admin'
	  	,TO_CHAR(SYSDATE , 'yyyy-mm-dd')
	  )
	 ]]>
	</insert>
	
	<select id="login" parameterType="first.sample.dto.LoginInfo" resultType="first.sample.dto.LoginInfo">
		SELECT
			ID
			,PW
			,NAME
			,PHONENUM
			,EMAIL
			,EMAIL2
			,ADDR1
			,ADDR2
			,ADDR3
			,RDATE
			,UPDATEDATE
		FROM
			LOGININFO
		WHERE
			ID=#{id} AND
			PW=#{pw}
				
	</select>
	
	<select id="viewMember" parameterType="first.sample.dto.LoginInfo" resultType="first.sample.dto.LoginInfo">
		SELECT
			ID
			,PW
			,NAME
		FROM
			LOGININFO
		WHERE
			ID=#{id} AND
			PW=#{pw}	
	</select>
	
	<insert id="join" parameterType="first.sample.dto.LoginInfo">
		INSERT INTO LOGININFO
		(
				ID
			,PW
			,NAME
			,EMAIL
			,EMAIL2
			,PHONENUM
			,ADDR1
			,ADDR2
			,ADDR3
			,ADDR4
		)
		VALUES
		(
			#{id}
			,#{pw}
			,#{name}
			,#{email}
			,#{email2}
			,#{phonenum}
			,#{addr1, jdbcType=VARCHAR}
			,#{addr2, jdbcType=VARCHAR}
			,#{addr3, jdbcType=VARCHAR}
			,#{addr4, jdbcType=VARCHAR}
			
		)
	</insert>
	
	
	<select id="selectAdminBoardsList" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
		SELECT
			
			BGNO,
			BONAME
			
		FROM
			TB_BOARD_LIST
		ORDER BY BGNO
		]]>
	</select>
	
	<select id="idcheck" parameterType="String" resultType="Integer">
      SELECT COUNT(*) FROM logininfo
      WHERE
          ID = #{ID}
</select>
	
</mapper>